@model IEnumerable<Broadpost.Controllers.ChannelStatusBinderr>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_UserLayout.cshtml";
}

<h1>Index</h1>

<ul class="list-group">
    @foreach (var item in ViewBag.invitations)
    {
        <li class="list-group-item list-group-item-success">
            <h5>@item.channel.ChannelName</h5>
            <small class="text-muted">@item.channel.UserId have sent you request to join his channel</small>
            <span class="float-right">
                <button class="btn btn-sm btn-success text-white" onclick="AcceptDeclineInvitation(this.parentNode.parentNode.style.display = 'none',@item.channel.ChannelId, 1)">Accept</button>
                <button class="btn btn-sm btn-danger text-white" onclick="AcceptDeclineInvitation(this.parentNode.parentNode.style.display = 'none',@item.channel.ChannelId, 2)">Decline</button>
            </span>
        </li>
    }
</ul>

<script>
    function AcceptDeclineInvitation(e,channelId,status)
    {
        var data =
        {
            ChannelId: `${channelId}`,
            Status: `${status}`
        }
        $.ajax({
            "type": "POST",
            "url": '/Invitation/HandleInviteResponse',
            "dataType": "json",
            "contentType": "application/json",
            "data": JSON.stringify(data)
        })

    }
</script>